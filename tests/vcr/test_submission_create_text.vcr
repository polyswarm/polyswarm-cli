interactions:
- request:
    body: '{"artifact_name": "malicious", "artifact_type": "FILE", "community": "gamma"}'
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - '11111111111111111111111111111111'
      Connection:
      - keep-alive
      Content-Length:
      - '77'
      Content-Type:
      - application/json
      User-Agent:
      - polyswarm-api/2.9.0 (x86_64-Linux-CPython-3.6.5)
    method: POST
    uri: http://artifact-index-e2e:9696/v2/instance
  response:
    body:
      string: '{"result":{"artifact_id":"41085571897967100","assertions":[],"community":"gamma","country":"","created":"2021-06-08T19:21:11.600149","detections":{"benign":0,"malicious":0,"total":0},"extended_type":null,"failed":false,"filename":"malicious","first_seen":"2021-06-08T19:21:11.600149","id":"41085571897967100","last_scanned":null,"last_seen":null,"md5":null,"metadata":[],"mimetype":null,"polyscore":null,"result":null,"sha1":null,"sha256":null,"size":null,"type":"FILE","upload_url":"http://minio:9000/instances/f6/b7/bd/f6b7bdea-88be-4bbf-9703-dd0808f11e76?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIOSFODNN7EXAMPLE%2F20210608%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210608T192111Z&X-Amz-Expires=300&X-Amz-SignedHeaders=host&X-Amz-Signature=f380a4d28e8e8a22922a245348247b635892fd7ce1da8677f4d5442ae8b06bf3","votes":[],"window_closed":false},"status":"OK"}

        '
    headers:
      Content-Length:
      - '874'
      Content-Type:
      - application/json
      Date:
      - Tue, 08 Jun 2021 19:21:11 GMT
      Server:
      - Werkzeug/1.0.1 Python/3.7.3
      X-Billing-ID:
      - '1'
    status:
      code: 200
      message: OK
- request:
    body: !!python/object/new:_io.BytesIO
      state: !!python/tuple
      - !!binary |
        WDVPIVAlQEFQWzRcUFpYNTQoUF4pN0NDKTd9JEVJQ0FSLVNUQU5EQVJELUFOVElWSVJVUy1URVNU
        LUZJTEUhJEgrSCo=
      - 0
      - null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      Content-Length:
      - '68'
      User-Agent:
      - python-requests/2.22.0
    method: PUT
    uri: http://minio:9000/instances/f6/b7/bd/f6b7bdea-88be-4bbf-9703-dd0808f11e76?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIOSFODNN7EXAMPLE%2F20210608%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210608T192111Z&X-Amz-Expires=300&X-Amz-SignedHeaders=host&X-Amz-Signature=f380a4d28e8e8a22922a245348247b635892fd7ce1da8677f4d5442ae8b06bf3
  response:
    body:
      string: ''
    headers:
      Accept-Ranges:
      - bytes
      Content-Length:
      - '0'
      Content-Security-Policy:
      - block-all-mixed-content
      Date:
      - Tue, 08 Jun 2021 19:21:11 GMT
      ETag:
      - '"44d88612fea8a8f36de82e1278abb02f"'
      Server:
      - MinIO/RELEASE.2020-11-06T23-17-07Z
      Vary:
      - Origin
      X-Amz-Request-Id:
      - 1686B1ACD7BDCF0F
      X-Xss-Protection:
      - 1; mode=block
      x-amz-expiration:
      - expiry-date="Thu, 10 Jun 2021 00:00:00 GMT", rule-id="instances_0"
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - '11111111111111111111111111111111'
      Connection:
      - keep-alive
      Content-Length:
      - '0'
      User-Agent:
      - polyswarm-api/2.9.0 (x86_64-Linux-CPython-3.6.5)
    method: PUT
    uri: http://artifact-index-e2e:9696/v2/instance?id=41085571897967100
  response:
    body:
      string: '{"result":{"artifact_id":"41085571897967100","assertions":[],"community":"gamma","country":"","created":"2021-06-08T19:21:11.600149","detections":{"benign":0,"malicious":0,"total":0},"extended_type":"EICAR
        virus test files","failed":false,"filename":"malicious","first_seen":"2021-06-02T20:48:09.422105","id":"41085571897967100","last_scanned":null,"last_seen":null,"md5":"44d88612fea8a8f36de82e1278abb02f","metadata":[],"mimetype":"text/plain","polyscore":null,"result":null,"sha1":"3395856ce81f2b7382dee72602f798b642f14140","sha256":"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f","size":68,"type":"FILE","upload_url":"http://minio:9000/instances/f6/b7/bd/f6b7bdea-88be-4bbf-9703-dd0808f11e76?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIOSFODNN7EXAMPLE%2F20210608%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210608T192111Z&X-Amz-Expires=300&X-Amz-SignedHeaders=host&X-Amz-Signature=f380a4d28e8e8a22922a245348247b635892fd7ce1da8677f4d5442ae8b06bf3","votes":[],"window_closed":false},"status":"OK"}

        '
    headers:
      Content-Length:
      - '1030'
      Content-Type:
      - application/json
      Date:
      - Tue, 08 Jun 2021 19:21:11 GMT
      Server:
      - Werkzeug/1.0.1 Python/3.7.3
      X-Billing-ID:
      - '1'
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - '*/*'
      Accept-Encoding:
      - gzip, deflate
      Authorization:
      - '11111111111111111111111111111111'
      Connection:
      - keep-alive
      User-Agent:
      - polyswarm-api/2.9.0 (x86_64-Linux-CPython-3.6.5)
    method: GET
    uri: http://artifact-index-e2e:9696/v2/consumer/submission/gamma/41085571897967100
  response:
    body:
      string: '{"result":{"artifact_id":"41085571897967100","assertions":[{"author":"47804624413777732","author_name":"microengine-webhooks-py","bid":"1000000000000000000","engine":{"description":"Webhook-Engine","name":"microengine-webhooks-py"},"mask":true,"metadata":null,"verdict":true}],"community":"gamma","country":"","created":"2021-06-08T19:21:11.600149","detections":{"benign":0,"malicious":1,"total":1},"extended_type":"EICAR
        virus test files","failed":false,"filename":"malicious","first_seen":"2021-06-02T20:48:09.422105","id":"41085571897967100","last_scanned":"2021-06-08T19:21:11.600149","last_seen":"2021-06-08T19:21:11.600149","md5":"44d88612fea8a8f36de82e1278abb02f","metadata":[{"created":"2021-06-02T21:19:22.616878","tool":"test_tool_2","tool_metadata":{"key2":"value2"},"updated":"2021-06-02T21:19:22.616878"},{"created":"2021-06-02T21:19:22.482709","tool":"test_tool_1","tool_metadata":{"key":"value"},"updated":"2021-06-02T21:19:22.482709"},{"created":"2021-06-02T20:48:10.544329","tool":"strings","tool_metadata":{"domains":[],"ipv4":[],"ipv6":[],"urls":[]},"updated":"2021-06-08T19:21:12.904646"},{"created":"2021-06-02T20:48:10.369795","tool":"hash","tool_metadata":{"md5":"44d88612fea8a8f36de82e1278abb02f","sha1":"3395856ce81f2b7382dee72602f798b642f14140","sha256":"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f","sha3_256":"8b4c4e204a8a039198e292d2291f4c451d80e4c38bf0cc04ad3841fea8755bd8","sha3_512":"a20290c6ebf01dc5182bb57718250f61ab11b418466714632a7d1474a02849641f7b78e4093e19ad12fdbedbe02f3bec4ca3ec3235557e82ab5ac02d061e7007","sha512":"cc805d5fab1fd71a4ab352a9c533e65fb2d5b885518f4e565e68847223b8e6b85cb48f3afad842726d99239c9e36505c64b0dc9a061d9e507d833277ada336ab","ssdeep":"3:a+JraNvsgzsVqSwHq9:tJuOgzsko","tlsh":"41a022003b0eee2ba20b00200032e8b00808020e2ce00a3820a020b8c83308803ec228"},"updated":"2021-06-08T19:21:12.921408"}],"mimetype":"text/plain","polyscore":0.230471691252541,"result":null,"sha1":"3395856ce81f2b7382dee72602f798b642f14140","sha256":"275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f","size":68,"type":"FILE","upload_url":"http://minio:9000/instances/f6/b7/bd/f6b7bdea-88be-4bbf-9703-dd0808f11e76?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIOSFODNN7EXAMPLE%2F20210608%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210608T192111Z&X-Amz-Expires=300&X-Amz-SignedHeaders=host&X-Amz-Signature=f380a4d28e8e8a22922a245348247b635892fd7ce1da8677f4d5442ae8b06bf3","votes":[{"arbiter":"73814264419852267","arbiter_name":"arbiter-webhooks-py","engine":{"description":"Webhook-Arbiter","name":"arbiter-webhooks-py"},"metadata":null,"vote":true}],"window_closed":true},"status":"OK"}

        '
    headers:
      Content-Length:
      - '2660'
      Content-Type:
      - application/json
      Date:
      - Tue, 08 Jun 2021 19:21:42 GMT
      Server:
      - Werkzeug/1.0.1 Python/3.7.3
      X-Billing-ID:
      - '1'
    status:
      code: 200
      message: OK
version: 1
